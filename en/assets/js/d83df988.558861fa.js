"use strict";(globalThis.webpackChunkdocs_site=globalThis.webpackChunkdocs_site||[]).push([[6121],{97702:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>i,contentTitle:()=>l,default:()=>h,frontMatter:()=>d,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"development/restart-upgrade","title":"Restart and Upgrade","description":"This page explains how to manage TGO service start/stop and version upgrades.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/development/restart-upgrade.md","sourceDirName":"development","slug":"/development/restart-upgrade","permalink":"/en/development/restart-upgrade","draft":false,"unlisted":false,"editUrl":"https://github.com/tgoai/tgo/edit/main/docs-site/docs/development/restart-upgrade.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"id":"restart-upgrade","title":"Restart and Upgrade","sidebar_position":2},"sidebar":"docsSidebar","previous":{"title":"\u6e90\u7801\u90e8\u7f72","permalink":"/en/development/source-deploy"},"next":{"title":"\u8c03\u8bd5\u5de5\u5177","permalink":"/en/development/debug-tools"}}');var r=s(74848),t=s(28453);const d={id:"restart-upgrade",title:"Restart and Upgrade",sidebar_position:2},l="Restart and Upgrade",i={},c=[{value:"Service Management",id:"service-management",level:2},{value:"Start Services",id:"start-services",level:3},{value:"Stop Services",id:"stop-services",level:3},{value:"Restart Services",id:"restart-services",level:3},{value:"Restart Single Service",id:"restart-single-service",level:3},{value:"Version Upgrade",id:"version-upgrade",level:2},{value:"Upgrade to Latest Version",id:"upgrade-to-latest-version",level:3},{value:"Upgrade Command Options",id:"upgrade-command-options",level:3},{value:"Install Mode Memory",id:"install-mode-memory",level:3},{value:"Uninstall",id:"uninstall",level:2},{value:"Stop and Remove Services",id:"stop-and-remove-services",level:3},{value:"Complete Cleanup",id:"complete-cleanup",level:3},{value:"Backup and Restore",id:"backup-and-restore",level:2},{value:"Backup Data",id:"backup-data",level:3},{value:"Restore Data",id:"restore-data",level:3},{value:"Database Backup",id:"database-backup",level:3},{value:"Health Check",id:"health-check",level:2}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"restart-and-upgrade",children:"Restart and Upgrade"})}),"\n",(0,r.jsx)(n.p,{children:"This page explains how to manage TGO service start/stop and version upgrades."}),"\n",(0,r.jsx)(n.h2,{id:"service-management",children:"Service Management"}),"\n",(0,r.jsx)(n.h3,{id:"start-services",children:"Start Services"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"./tgo.sh up\n"})}),"\n",(0,r.jsx)(n.p,{children:"Source mode:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"./tgo.sh up --source\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stop-services",children:"Stop Services"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"./tgo.sh down\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Stop and remove data volumes (",(0,r.jsx)(n.strong,{children:"data will be lost"}),"):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"./tgo.sh down --volumes\n"})}),"\n",(0,r.jsx)(n.h3,{id:"restart-services",children:"Restart Services"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"./tgo.sh down\n./tgo.sh up\n"})}),"\n",(0,r.jsx)(n.h3,{id:"restart-single-service",children:"Restart Single Service"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"docker compose restart tgo-api\n"})}),"\n",(0,r.jsx)(n.h2,{id:"version-upgrade",children:"Version Upgrade"}),"\n",(0,r.jsx)(n.h3,{id:"upgrade-to-latest-version",children:"Upgrade to Latest Version"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"./tgo.sh upgrade\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"upgrade"})," command automatically:"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Pulls latest code"}),"\n",(0,r.jsx)(n.li,{children:"Updates Docker images"}),"\n",(0,r.jsx)(n.li,{children:"Runs database migrations"}),"\n",(0,r.jsx)(n.li,{children:"Restarts all services"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"upgrade-command-options",children:"Upgrade Command Options"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"./tgo.sh upgrade [--source] [--cn]\n"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Option"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"--source"})}),(0,r.jsx)(n.td,{children:"Build from source (instead of pre-built images)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"--cn"})}),(0,r.jsx)(n.td,{children:"Use China mirrors for acceleration"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"install-mode-memory",children:"Install Mode Memory"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"upgrade"})," remembers the mode used during initial installation. For example:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Initial install with China mirrors\n./tgo.sh install --cn\n\n# Subsequent upgrades auto-use --cn\n./tgo.sh upgrade\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Configuration is saved in ",(0,r.jsx)(n.code,{children:"./data/.tgo-install-mode"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"uninstall",children:"Uninstall"}),"\n",(0,r.jsx)(n.h3,{id:"stop-and-remove-services",children:"Stop and Remove Services"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"./tgo.sh uninstall\n"})}),"\n",(0,r.jsx)(n.p,{children:"This command will:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Stop all containers"}),"\n",(0,r.jsx)(n.li,{children:"Remove containers"}),"\n",(0,r.jsx)(n.li,{children:"Ask whether to delete data"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"complete-cleanup",children:"Complete Cleanup"}),"\n",(0,r.jsx)(n.p,{children:"For complete cleanup of all data:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Stop services\n./tgo.sh down --volumes\n\n# Remove data directory\nrm -rf ./data\n\n# Remove config files\nrm -f .env\nrm -rf ./envs\n"})}),"\n",(0,r.jsx)(n.h2,{id:"backup-and-restore",children:"Backup and Restore"}),"\n",(0,r.jsx)(n.h3,{id:"backup-data",children:"Backup Data"}),"\n",(0,r.jsxs)(n.p,{children:["Main data is stored in ",(0,r.jsx)(n.code,{children:"./data"})," directory:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Create backup\ntar -czvf tgo-backup-$(date +%Y%m%d).tar.gz ./data\n"})}),"\n",(0,r.jsx)(n.h3,{id:"restore-data",children:"Restore Data"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Stop services\n./tgo.sh down\n\n# Restore data\ntar -xzvf tgo-backup-20240101.tar.gz\n\n# Start services\n./tgo.sh up\n"})}),"\n",(0,r.jsx)(n.h3,{id:"database-backup",children:"Database Backup"}),"\n",(0,r.jsx)(n.p,{children:"Backup PostgreSQL database separately:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Export database\ndocker compose exec postgres pg_dump -U tgo tgo > tgo-db-backup.sql\n\n# Restore database\ndocker compose exec -T postgres psql -U tgo tgo < tgo-db-backup.sql\n"})}),"\n",(0,r.jsx)(n.h2,{id:"health-check",children:"Health Check"}),"\n",(0,r.jsx)(n.p,{children:"Check all service status:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"./tgo.sh doctor\n"})}),"\n",(0,r.jsx)(n.p,{children:"Example output:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"=========================================\n  TGO Service Health Check\n=========================================\n\n  \u2705 tgo-api           running (healthy)\n  \u2705 tgo-ai            running (healthy)\n  \u2705 tgo-rag           running (healthy)\n  \u2705 tgo-web           running\n  \u2705 postgres          running (healthy)\n  \u2705 redis             running (healthy)\n  \u2705 nginx             running\n\n-----------------------------------------\nSummary: 7/7 services healthy\n"})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}}}]);